<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Title -->
    <title>Report</title>

    <!-- Styles -->
    @Styles.Render("~/Content/css")
</head>
<body>

    <div id="wrapper">
        <!-- Header -->
        @Html.Partial("SoftwareHeader")

        <div id="page-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <h3 class="">
                            <i class="fa fa-print fa-fw"></i>  Reports <small>Generate and Print Reports</small>
                        </h3>
                        <ol class="breadcrumb">
                            <li>
                                <a href="/Software">Dashboard</a>
                            </li>
                            <li class="active">
                                Reports
                            </li>
                        </ol>
                    </div>
                </div>
                <ul class="nav nav-tabs">
                    <li class="active"><a data-toggle="tab" href="#loanReport">Loan / Renew / Reconstruct Reports</a></li>
                    <li><a data-toggle="tab" href="#collectionReport">Collection / Remittance Report</a></li>
                    <li><a data-toggle="tab" href="#expensesReport">Expenses Report</a></li>
                </ul>
                <br />
                <div class="tab-content">
                    <div id="loanReport" class="tab-pane fade in active">
                        <ul class="nav nav-pills" style="background-color: #f7f7f7">
                            <li class="active"><a data-toggle="pill" href="#dailyReleaseMonitoringReport" onclick="dailyReleaseMonitoringReportTabPillsOnclick()">Daily Release Monitoring</a></li>
                            <li><a data-toggle="pill" href="#loanSummaryReport" onclick="loanSummaryReportTabPillsOnclick()">Loan Summary Report</a></li>
                            <li><a data-toggle="pill" href="#renewSummaryReport" onclick="renewSummaryReportTabPillsOnclick()">Renew Summary Report</a></li>
                            <li><a data-toggle="pill" href="#reconstructSummaryReport" onclick="reconstructSummaryReportTabPillsOnclick()">Reconstruct / Overdue Summary Report</a></li>
                        </ul>
                        <br />
                        <div class="tab-content">
                            <div id="dailyReleaseMonitoringReport" class="tab-pane fade in active">
                                <div class="panel panel-default">
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 61%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"><i class="fa fa-search fa-fw"></i> </span>
                                                        <input type="text" id="dailyReleaseMonitoringReportSearchInput" class="form-control" placeholder="Search" />
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 38%;"></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Start Date</span>
                                                        <div id="cboStartDateDailyReleaseMonitoringReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> End Date</span>
                                                        <div id="cboEndDateDailyReleaseMonitoringReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 28%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Area</span>
                                                        <div id="cboDailyReleaseMonitoringArea" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 9%;" align="right">
                                                    <button class="btn btn-primary btn-block" onclick="btnPrintDailyReleaseMonitoringReportPrint()"><i class="fa fa-print fa-fw"></i> Print</button>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-body">
                                        <div id="dailyReleaseMonitoringFlexGrid"></div>
                                    </div>
                                    <div class="panel-footer">
                                        <div class="row">
                                            <div class="btn-group col-md-7" id="naviagtionPageGrid">
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToFirstPageGrid">
                                                    <span class="glyphicon glyphicon-fast-backward"></span> First
                                                </button>
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToPreviousPageGrid">
                                                    <span class="glyphicon glyphicon-step-backward"></span> Previous
                                                </button>
                                                <button type="button" class="btn btn-default border-custom" disabled style="width: 100px" id="btnCurrentPageGrid"></button>
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToNextPageGrid">
                                                    <span class="glyphicon glyphicon-step-forward"></span> Next
                                                </button>
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToLastPageGrid">
                                                    <span class="glyphicon glyphicon-fast-forward"></span> Last
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="loanSummaryReport" class="tab-pane fade">
                                <div class="panel panel-default">
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 61%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"><i class="fa fa-search fa-fw"></i> </span>
                                                        <input type="text" id="loanSummaryReportSearchInput" class="form-control" placeholder="Search" />
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 38%;"></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Start Date</span>
                                                        <div id="cboStartDateLoanSummaryReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> End Date</span>
                                                        <div id="cboEndDateLoanSummaryReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 28%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Area</span>
                                                        <div id="cboLoanSummaryReportArea" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 9%;" align="right">
                                                    <button class="btn btn-primary btn-block" onclick="btnPrintLoanSummaryReporPrint()"><i class="fa fa-print fa-fw"></i> Print</button>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-body">
                                        <div id="loanSummaryReportFlexGrid"></div>
                                    </div>
                                    <div class="panel-footer">
                                        <div class="row">
                                            <div class="btn-group col-md-7" id="naviagtionPageGridLoanSummary">
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToFirstPageGridLoanSummary">
                                                    <span class="glyphicon glyphicon-fast-backward"></span> First
                                                </button>
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToPreviousPageGridLoanSummary">
                                                    <span class="glyphicon glyphicon-step-backward"></span> Previous
                                                </button>
                                                <button type="button" class="btn btn-default border-custom" disabled style="width: 100px" id="btnCurrentPageGridLoanSummary"></button>
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToNextPageGridLoanSummary">
                                                    <span class="glyphicon glyphicon-step-forward"></span> Next
                                                </button>
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToLastPageGridLoanSummary">
                                                    <span class="glyphicon glyphicon-fast-forward"></span> Last
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="renewSummaryReport" class="tab-pane fade">
                                <div class="panel panel-default">
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 61%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"><i class="fa fa-search fa-fw"></i> </span>
                                                        <input type="text" id="renewSummaryReportSearchInput" class="form-control" placeholder="Search" />
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 38%;"></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Start Date</span>
                                                        <div id="cboStartDateRenewSummaryReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> End Date</span>
                                                        <div id="cboEndDateRenewSummaryReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 28%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Area</span>
                                                        <div id="cboRenewSummaryReportArea" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 9%;" align="right">
                                                    <button class="btn btn-primary btn-block" onclick="btnPrintRenewSummaryReporPrint()"><i class="fa fa-print fa-fw"></i> Print</button>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-body">
                                        <div id="renewSummaryReportFlexGrid"></div>
                                    </div>
                                    <div class="panel-footer">
                                        <div class="row">
                                            <div class="btn-group col-md-7" id="naviagtionPageGridRenewSummary">
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToFirstPageGridRenewSummary">
                                                    <span class="glyphicon glyphicon-fast-backward"></span> First
                                                </button>
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToPreviousPageGridRenewSummary">
                                                    <span class="glyphicon glyphicon-step-backward"></span> Previous
                                                </button>
                                                <button type="button" class="btn btn-default border-custom" disabled style="width: 100px" id="btnCurrentPageGridRenewSummary"></button>
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToNextPageGridRenewSummary">
                                                    <span class="glyphicon glyphicon-step-forward"></span> Next
                                                </button>
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToLastPageGridRenewSummary">
                                                    <span class="glyphicon glyphicon-fast-forward"></span> Last
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="reconstructSummaryReport" class="tab-pane fade">
                                <div class="panel panel-default">
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 61%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"><i class="fa fa-search fa-fw"></i> </span>
                                                        <input type="text" id="reconstructSummaryReportSearchInput" class="form-control" placeholder="Search" />
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 38%;"></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Start Date</span>
                                                        <div id="cboStartDateReconstructSummaryReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> End Date</span>
                                                        <div id="cboEndDateReconstructSummaryReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 28%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Area</span>
                                                        <div id="cboReconstructSummaryReportArea" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 9%;" align="right">
                                                    <button class="btn btn-primary btn-block" onclick="btnPrintReconstructSummaryReporPrint()"><i class="fa fa-print fa-fw"></i> Print</button>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-body">
                                        <div id="reconstructSummaryReportFlexGrid"></div>
                                    </div>
                                    <div class="panel-footer">
                                        <div class="row">
                                            <div class="btn-group col-md-7" id="naviagtionPageGridReconstructSummary">
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToFirstPageGridReconstructSummary">
                                                    <span class="glyphicon glyphicon-fast-backward"></span> First
                                                </button>
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToPreviousPageGridReconstructSummary">
                                                    <span class="glyphicon glyphicon-step-backward"></span> Previous
                                                </button>
                                                <button type="button" class="btn btn-default border-custom" disabled style="width: 100px" id="btnCurrentPageGridReconstructSummary"></button>
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToNextPageGridReconstructSummary">
                                                    <span class="glyphicon glyphicon-step-forward"></span> Next
                                                </button>
                                                <button type="button" class="btn btn-default border-custom" id="btnMoveToLastPageGridReconstructSummary">
                                                    <span class="glyphicon glyphicon-fast-forward"></span> Last
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="collectionReport" class="tab-pane fade">
                        <ul class="nav nav-pills" style="background-color: #f7f7f7">
                            <li class="active"><a data-toggle="pill" href="#collectionReportActive">Active Collection</a></li>
                            <li><a data-toggle="pill" href="#collectionReportOverdue">Overdue Collection</a></li>
                            <li><a data-toggle="pill" href="#dailyCollectionAndRemittanceReport">Daily Collection and Remittance</a></li>
                        </ul>
                        <br />
                        <div class="tab-content">
                            <div id="collectionReportActive" class="tab-pane fade in active">
                                <div class="panel panel-default">
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 59%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"><i class="fa fa-search fa-fw"></i> </span>
                                                        <input type="text" id="collectionReportActiveSearchInput" class="form-control" placeholder="Search" />
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 40%;"></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Start Date</span>
                                                        <div id="cboStartDateCollectionReportActiveReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> End Date</span>
                                                        <div id="cboEndDateCollectionReportActiveReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 28%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Area</span>
                                                        <div id="cboCollectionReportActiveArea" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 9%;" align="right">
                                                    <button class="btn btn-primary btn-block" onclick="btnPrintCollectionReportActiveReport()"><i class="fa fa-print fa-fw"></i> Print</button>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-body">

                                    </div>
                                </div>
                            </div>
                            <div id="collectionReportOverdue" class="tab-pane fade">
                                <div class="panel panel-default">
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 59%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"><i class="fa fa-search fa-fw"></i> </span>
                                                        <input type="text" id="collectionReportOverdueSearchInput" class="form-control" placeholder="Search" />
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 40%;"></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Start Date</span>
                                                        <div id="cboStartDateCollectionReportOverdueReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> End Date</span>
                                                        <div id="cboEndDateCollectionReportOverdueReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 28%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Area</span>
                                                        <div id="cboCollectionReportOverdueArea" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 9%;" align="right">
                                                    <button class="btn btn-primary btn-block" onclick="btnPrintCollectionReportOverdueReport()"><i class="fa fa-print fa-fw"></i> Print</button>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-body">

                                    </div>
                                </div>
                            </div>
                            <div id="dailyCollectionAndRemittanceReport" class="tab-pane fade">
                                <div class="panel panel-default">
                                    <div class="panel-heading" align="right">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td style="width: 28%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"><i class="fa fa-search fa-fw"></i> </span>
                                                        <input type="text" id="dailyCollectionAndRemittanceReportSearchInput" class="form-control" placeholder="Search" />
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> Start Date</span>
                                                        <div id="cboStartDateDailyCollectionAndRemittanceReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 30%;">
                                                    <div class="input-group">
                                                        <span class="input-group-addon"> End Date</span>
                                                        <div id="cboEndDateDailyCollectionAndRemittanceReport" style="width: 100%;"></div>
                                                    </div>
                                                </td>
                                                <td style="width: 1%;"></td>
                                                <td style="width: 9%;" align="right">
                                                    <button class="btn btn-primary btn-block" onclick="btnDateDailyCollectionAndRemittanceReportPrint()"><i class="fa fa-print fa-fw"></i> Print</button>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="panel-body">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="expensesReport" class="tab-pane fade">
                        <div class="panel panel-default">
                            <div class="panel-heading" align="right">
                                <table border="0" style="width: 100%;">
                                    <tr>
                                        <td style="width: 28%;">
                                            <div class="input-group">
                                                <span class="input-group-addon"><i class="fa fa-search fa-fw"></i> </span>
                                                <input type="text" id="expensesReportSearchInput" class="form-control" placeholder="Search" />
                                            </div>
                                        </td>
                                        <td style="width: 1%;"></td>
                                        <td style="width: 30%;">
                                            <div class="input-group">
                                                <span class="input-group-addon"> Start Date</span>
                                                <div id="cboStartExpensesReport" style="width: 100%;"></div>
                                            </div>
                                        </td>
                                        <td style="width: 1%;"></td>
                                        <td style="width: 30%;">
                                            <div class="input-group">
                                                <span class="input-group-addon"> End Date</span>
                                                <div id="cboEndExpensesReport" style="width: 100%;"></div>
                                            </div>
                                        </td>
                                        <td style="width: 1%;"></td>
                                        <td style="width: 9%;" align="right">
                                            <button class="btn btn-primary btn-block" onclick="btnExpensesReportPrint()"><i class="fa fa-print fa-fw"></i> Print</button>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="panel-body">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    <script type="text/javascript">
        var dailyReleaseMonitoringCollectionView;
        var dailyReleaseMonitoringFlexGrid;
        var cboStartDateDailyReleaseMonitoringReport;
        var cboEndDateDailyReleaseMonitoringReport;
        var cboStartDateDailyReleaseMonitoringReportIsClicked = false;
        var cboEndDateDailyReleaseMonitoringReportIsClicked = false;

        var loanRenewReconstructSummaryReportCollectionView;
        var loanSummaryReportFlexGrid;
        var renewSummaryReportFlexGrid;
        var reconstructSummaryReportFlexGrid;

        function createCboArea() {
            var areaArray = new Array();
            $.ajax({
                url: '/api/area/list',
                cache: false,
                type: 'GET',
                contentType: 'application/json; charset=utf-8',
                data: {},
                success: function (areaResults) {
                    var disabled = true;
                    if (areaResults.length > 0) {
                        for (i = 0; i < areaResults.length; i++) {
                            areaArray.push({
                                Id: areaResults[i]["Id"],
                                Area: areaResults[i]["Area"]
                            });
                        }

                        disabled = false;
                    }

                    cboDailyReleaseMonitoringArea.dispose();
                    cboDailyReleaseMonitoringArea = new wijmo.input.ComboBox('#cboDailyReleaseMonitoringArea', {
                        disabled: disabled,
                        placeholder: "Select",
                        itemsSource: areaArray,
                        isEditable: false,
                        required: true,
                        displayMemberPath: "Area",
                        selectedValuePath: "Area",
                        onSelectedIndexChanged: function () {
                            NProgress.start();
                            refreshDailyReleaseMonitoring();
                        }
                    });

                    cboStartDateDailyReleaseMonitoringReport = new wijmo.input.InputDate('#cboStartDateDailyReleaseMonitoringReport');
                    createCboForDailyReleaseMonitoringStartDate();

                    cboLoanSummaryReportArea.dispose();
                    cboLoanSummaryReportArea = new wijmo.input.ComboBox('#cboLoanSummaryReportArea', {
                        disabled: disabled,
                        placeholder: "Select",
                        itemsSource: areaArray,
                        isEditable: false,
                        required: true,
                        displayMemberPath: "Area",
                        selectedValuePath: "Area",
                        onSelectedIndexChanged: function () {
                            NProgress.start();
                            refreshLoanSummaryReportFlexGrid();
                        }
                    });

                    cboRenewSummaryReportArea.dispose();
                    cboRenewSummaryReportArea = new wijmo.input.ComboBox('#cboRenewSummaryReportArea', {
                        disabled: disabled,
                        placeholder: "Select",
                        itemsSource: areaArray,
                        isEditable: false,
                        required: true,
                        displayMemberPath: "Area",
                        selectedValuePath: "Area",
                        onSelectedIndexChanged: function () {
                            NProgress.start();
                            refreshRenewSummaryReportFlexGrid();
                        }
                    });

                    cboReconstructSummaryReportArea.dispose();
                    cboReconstructSummaryReportArea = new wijmo.input.ComboBox('#cboReconstructSummaryReportArea', {
                        disabled: disabled,
                        placeholder: "Select",
                        itemsSource: areaArray,
                        isEditable: false,
                        required: true,
                        displayMemberPath: "Area",
                        selectedValuePath: "Area",
                        onSelectedIndexChanged: function () {
                            NProgress.start();
                            refreshReconstructSummaryReportFlexGrid();
                        }
                    });
                }
            });
        }

        function createCboForDailyReleaseMonitoringStartDate() {
            cboStartDateDailyReleaseMonitoringReport.dispose();
            cboStartDateDailyReleaseMonitoringReport = new wijmo.input.InputDate('#cboStartDateDailyReleaseMonitoringReport', {
                format: 'MM-dd-yyyy',
                value: new Date(),
                mask: '99-99-9999',
                onValueChanged: function () {
                    if (cboStartDateDailyReleaseMonitoringReportIsClicked) {
                        NProgress.start();
                        refreshDailyReleaseMonitoring();
                    } else {
                        cboStartDateDailyReleaseMonitoringReportIsClicked = true;
                    }
                }
            });

            cboEndDateDailyReleaseMonitoringReport = new wijmo.input.InputDate('#cboEndDateDailyReleaseMonitoringReport');
            createCboForDailyReleaseMonitoringEndDate();
        }

        function createCboForDailyReleaseMonitoringEndDate() {
            cboEndDateDailyReleaseMonitoringReport.dispose();
            cboEndDateDailyReleaseMonitoringReport = new wijmo.input.InputDate('#cboEndDateDailyReleaseMonitoringReport', {
                format: 'MM-dd-yyyy',
                value: new Date(),
                mask: '99-99-9999',
                onValueChanged: function () {
                    if (cboEndDateDailyReleaseMonitoringReportIsClicked) {
                        NProgress.start();
                        refreshDailyReleaseMonitoring();
                    } else {
                        cboEndDateDailyReleaseMonitoringReportIsClicked = true;
                    }
                }
            });

            createDailyReleaseMonitoringFlexGrid();
        }

        function getDailyReleaseMonitoring() {
            var loanApplicationListArray = new wijmo.collections.ObservableArray;
            var loanStartDate = [cboStartDateDailyReleaseMonitoringReport.value.getMonth() + 1, cboStartDateDailyReleaseMonitoringReport.value.getDate(), cboStartDateDailyReleaseMonitoringReport.value.getFullYear()].join('-');
            var loanEndDate = [cboEndDateDailyReleaseMonitoringReport.value.getMonth() + 1, cboEndDateDailyReleaseMonitoringReport.value.getDate(), cboEndDateDailyReleaseMonitoringReport.value.getFullYear()].join('-');

            $.ajax({
                url: '/api/loan/dailyReleaseMonitoring/' + cboDailyReleaseMonitoringArea.selectedItem["Id"] + '/' + loanStartDate + '/' + loanEndDate,
                cache: false,
                type: 'GET',
                contentType: 'application/json; charset=utf-8',
                success: function (loanApplicationListResult) {
                    if (loanApplicationListResult.length > 0) {
                        for (i = 0; i < loanApplicationListResult.length; i++) {
                            var newLoanDate = new Date(loanApplicationListResult[i]["LoanDate"]);
                            var loanDate = ('0' + (newLoanDate.getMonth() + 1)).slice(-2) + '-' + ('0' + newLoanDate.getDate()).slice(-2) + '-' + newLoanDate.getFullYear();

                            var newDueDate = new Date(loanApplicationListResult[i]["MaturityDate"]);
                            var dueDate = ('0' + (newDueDate.getMonth() + 1)).slice(-2) + '-' + ('0' + newDueDate.getDate()).slice(-2) + '-' + newDueDate.getFullYear();

                            var transactionType = "btnDetailLoan()";
                            if (loanApplicationListResult[i]["IsLoanRenew"]) {
                                transactionType = "btnDetailRenew()";
                            }

                            loanApplicationListArray.push({
                                BtnDetail: "<button class='btn btn-primary btn-xs btn-block' onclick='" + transactionType + "'><i class='fa fa-edit fa-fw'></i> Detail</button>",
                                Id: loanApplicationListResult[i]["Id"],
                                LoanNumber: loanApplicationListResult[i]["LoanNumber"],
                                Applicant: loanApplicationListResult[i]["Applicant"],
                                LoanDate: loanDate,
                                DueDate: dueDate,
                                Area: loanApplicationListResult[i]["Area"],
                                Particulars: loanApplicationListResult[i]["Particulars"],
                                PrincipalAmount: loanApplicationListResult[i]["PrincipalAmount"],
                                InterestAmount: loanApplicationListResult[i]["InterestAmount"],
                                DeductionAmount: loanApplicationListResult[i]["DeductionAmount"],
                                NetAmount: loanApplicationListResult[i]["NetAmount"],
                                NetCollectionAmount: loanApplicationListResult[i]["NetCollectionAmount"],
                                TotalPaidAmount: loanApplicationListResult[i]["TotalPaidAmount"],
                                TotalPenaltyAmount: loanApplicationListResult[i]["TotalPenaltyAmount"],
                                TotalBalanceAmount: loanApplicationListResult[i]["TotalBalanceAmount"],
                                IsLocked: loanApplicationListResult[i]["IsLocked"],
                                CreatedByUserId: loanApplicationListResult[i]["CreatedByUserId"],
                                CreatedByUser: loanApplicationListResult[i]["CreatedByUser"],
                                CreatedDateTime: loanApplicationListResult[i]["CreatedDateTime"],
                                UpdatedByUserId: loanApplicationListResult[i]["UpdatedByUserId"],
                                UpdatedByUser: loanApplicationListResult[i]["UpdatedByUser"],
                                UpdatedDateTime: loanApplicationListResult[i]["UpdatedDateTime"],
                            });
                        }
                    }

                    NProgress.done();
                }
            });

            return loanApplicationListArray;
        }

        function btnDetailLoan() {
            dailyReleaseMonitoringCollectionView.editItem(dailyReleaseMonitoringCollectionView.currentItem);
            var currentItem = dailyReleaseMonitoringCollectionView.currentEditItem;
            window.open("/Software/LoanApplicationDetail?id=" + currentItem.Id, "_blank");
        }

        function btnDetailRenew() {
            dailyReleaseMonitoringCollectionView.editItem(dailyReleaseMonitoringCollectionView.currentItem);
            var currentItem = dailyReleaseMonitoringCollectionView.currentEditItem;
            window.open("/Software/RenewDetail?id=" + currentItem.Id, "_blank");
        }

        function updateNavigateButtonsDailyReleaseMonitoring() {
            if (dailyReleaseMonitoringCollectionView.pageSize <= 0) {
                document.getElementById('naviagtionPageGrid').style.display = 'none';
                return;
            }
            document.getElementById('naviagtionPageGrid').style.display = 'block';
            btnCurrentPageGrid.innerHTML = (dailyReleaseMonitoringCollectionView.pageIndex + 1) + ' / ' + dailyReleaseMonitoringCollectionView.pageCount;
        }

        function refreshDailyReleaseMonitoring() {
            dailyReleaseMonitoringCollectionView = new wijmo.collections.CollectionView(getDailyReleaseMonitoring());
            dailyReleaseMonitoringCollectionView.canFilter = true;
            dailyReleaseMonitoringCollectionView.pageSize = 15;

            var filterText = '';
            $('#dailyReleaseMonitoringReportSearchInput').keyup(function () {
                filterText = this.value.toLowerCase();
                dailyReleaseMonitoringCollectionView.refresh();
            });

            dailyReleaseMonitoringCollectionView.filter = function (item) {
                return !filterText || (item.LoanNumber.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Applicant.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Area.toLowerCase().indexOf(filterText) > -1);
            }

            dailyReleaseMonitoringCollectionView.collectionChanged.addHandler(function (sender, args) {
                updateNavigateButtonsDailyReleaseMonitoring();
            });

            dailyReleaseMonitoringFlexGrid.itemsSource = dailyReleaseMonitoringCollectionView;
            dailyReleaseMonitoringFlexGrid.trackChanges = true;
        }

        function createDailyReleaseMonitoringFlexGrid() {
            dailyReleaseMonitoringCollectionView = new wijmo.collections.CollectionView(getDailyReleaseMonitoring());
            dailyReleaseMonitoringCollectionView.canFilter = true;
            dailyReleaseMonitoringCollectionView.pageSize = 15;

            var filterText = '';
            $('#dailyReleaseMonitoringReportSearchInput').keyup(function () {
                filterText = this.value.toLowerCase();
                dailyReleaseMonitoringCollectionView.refresh();
            });

            dailyReleaseMonitoringCollectionView.filter = function (item) {
                return !filterText || (item.LoanNumber.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Applicant.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Area.toLowerCase().indexOf(filterText) > -1);
            }

            dailyReleaseMonitoringCollectionView.collectionChanged.addHandler(function (sender, args) {
                updateNavigateButtonsDailyReleaseMonitoring();
            });

            // Flex Grid
            dailyReleaseMonitoringFlexGrid = new wijmo.grid.FlexGrid('#dailyReleaseMonitoringFlexGrid');
            dailyReleaseMonitoringFlexGrid.initialize({
                columns: [
                            {
                                "header": "Detail",
                                "binding": "BtnDetail",
                                "width": 80,
                                "align": "center",
                                "allowResizing": false,
                                "isContentHtml": true
                            },
                            {
                                "header": "Doc. No.",
                                "binding": "LoanNumber",
                                "allowSorting": true,
                                "width": 150,
                            },
                            {
                                "header": "Applicant",
                                "binding": "Applicant",
                                "allowSorting": true,
                                "width": 250,
                            },
                            {
                                "header": "Loan Date",
                                "binding": "LoanDate",
                                "allowSorting": true,
                                "width": 100,
                            },
                            {
                                "header": "Due Date",
                                "binding": "DueDate",
                                "allowSorting": true,
                                "width": 100,
                            },
                            {
                                "header": "Area",
                                "binding": "Area",
                                "allowSorting": true,
                                "width": 185,
                            },
                            {
                                "header": "Net",
                                "binding": "NetAmount",
                                "allowSorting": true,
                                "width": 160,
                            }
                ],
                autoGenerateColumns: false,
                itemsSource: dailyReleaseMonitoringCollectionView,
                isReadOnly: true,
                autoSizeMode: wijmo.grid.AutoSizeMode.Both,
                allowDragging: wijmo.grid.AllowDragging.None,
                selectionMode: wijmo.grid.SelectionMode.Row
            });

            dailyReleaseMonitoringFlexGrid.trackChanges = true;

            //Navigation button
            btnFirstPageGrid = document.getElementById('btnMoveToFirstPageGrid');
            btnPreviousPageGrid = document.getElementById('btnMoveToPreviousPageGrid');
            btnNextPageGrid = document.getElementById('btnMoveToNextPageGrid');
            btnLastPageGrid = document.getElementById('btnMoveToLastPageGrid');
            btnCurrentPageGrid = document.getElementById('btnCurrentPageGrid');

            updateNavigateButtonsDailyReleaseMonitoring();

            btnFirstPageGrid.addEventListener('click', function () {
                dailyReleaseMonitoringCollectionView.moveToFirstPage();
                updateNavigateButtonsDailyReleaseMonitoring();
            });
            btnPreviousPageGrid.addEventListener('click', function () {
                dailyReleaseMonitoringCollectionView.moveToPreviousPage();
                updateNavigateButtonsDailyReleaseMonitoring();
            });
            btnNextPageGrid.addEventListener('click', function () {
                dailyReleaseMonitoringCollectionView.moveToNextPage();
                updateNavigateButtonsDailyReleaseMonitoring();
            });
            btnLastPageGrid.addEventListener('click', function () {
                dailyReleaseMonitoringCollectionView.moveToLastPage();
                updateNavigateButtonsDailyReleaseMonitoring();
            });
        }

        var cboStartDateLoanSummaryReportIsClicked = false;
        var cboEndDateLoanSummaryReportIsClicked = false;

        function createCboStartDateLoanSummaryReport() {
            cboStartDateLoanSummaryReport.dispose();
            cboStartDateLoanSummaryReport = new wijmo.input.InputDate('#cboStartDateLoanSummaryReport', {
                format: 'MM-dd-yyyy',
                value: new Date(),
                mask: '99-99-9999',
                onValueChanged: function () {
                    if (cboStartDateLoanSummaryReportIsClicked) {
                        NProgress.start();
                        refreshLoanSummaryReportFlexGrid();
                    } else {
                        cboStartDateLoanSummaryReportIsClicked = true;
                    }
                }
            });
        }

        function createCboEndDateLoanSummaryReport() {
            cboEndDateLoanSummaryReport.dispose();
            cboEndDateLoanSummaryReport = new wijmo.input.InputDate('#cboEndDateLoanSummaryReport', {
                format: 'MM-dd-yyyy',
                value: new Date(),
                mask: '99-99-9999',
                onValueChanged: function () {
                    if (cboEndDateLoanSummaryReportIsClicked) {
                        NProgress.start();
                        refreshLoanSummaryReportFlexGrid();
                    } else {
                        cboEndDateLoanSummaryReportIsClicked = true;
                    }
                }
            });
        }

        function dailyReleaseMonitoringReportTabPillsOnclick() {
            NProgress.start();
            setTimeout(function () {
                refreshLoanSummaryReportFlexGrid();
            }, 200);
        }

        var isDataLoad = false;
        function loanSummaryReportTabPillsOnclick() {
            NProgress.start();
            setTimeout(function () {
                createLoanSummaryReportFlexGrid();
                window.createLoanSummaryReportFlexGrid = function () {
                    return true;
                }

                if (isDataLoad) {
                    refreshLoanSummaryReportFlexGrid();
                } else {
                    isDataLoad = true;
                }
            }, 200);
        }

        var isRenewDataLoad = false;
        function renewSummaryReportTabPillsOnclick() {
            NProgress.start();
            setTimeout(function () {
                createRenewSummaryReportFlexGrid();
                window.createRenewSummaryReportFlexGrid = function () {
                    return true;
                }

                if (isRenewDataLoad) {
                    refreshRenewSummaryReportFlexGrid();
                } else {
                    isRenewDataLoad = true;
                }
            }, 200);
        }

        var isRconstructDataLoad = false;
        function reconstructSummaryReportTabPillsOnclick() {
            NProgress.start();
            setTimeout(function () {
                createReconstructSummaryReportFlexGrid();
                window.createReconstructSummaryReportFlexGrid = function () {
                    return true;
                }

                if (isRconstructDataLoad) {
                    refreshReconstructSummaryReportFlexGrid();
                } else {
                    isRconstructDataLoad = true;
                }
            }, 200);
        }

        var cboStartDateRenewSummaryReportIsClicked = false;
        function createCboStartDateRenewSummaryReport() {
            cboStartDateRenewSummaryReport.dispose();
            cboStartDateRenewSummaryReport = new wijmo.input.InputDate('#cboStartDateRenewSummaryReport', {
                format: 'MM-dd-yyyy',
                value: new Date(),
                mask: '99-99-9999',
                onValueChanged: function () {
                    if (cboStartDateRenewSummaryReportIsClicked) {
                        NProgress.start();
                        refreshRenewSummaryReportFlexGrid();
                    } else {
                        cboStartDateRenewSummaryReportIsClicked = true;
                    }
                }
            });
        }

        var cboEndDateRenewSummaryReportIsClicked = false;
        function createCboEndDateRenewSummaryReport() {
            cboEndDateRenewSummaryReport.dispose();
            cboEndDateRenewSummaryReport = new wijmo.input.InputDate('#cboEndDateRenewSummaryReport', {
                format: 'MM-dd-yyyy',
                value: new Date(),
                mask: '99-99-9999',
                onValueChanged: function () {
                    if (cboEndDateRenewSummaryReportIsClicked) {
                        NProgress.start();
                        refreshRenewSummaryReportFlexGrid();
                    } else {
                        cboEndDateRenewSummaryReportIsClicked = true;
                    }
                }
            });
        }

        var cboStartDateReconstructSummaryReportIsClicked = false;
        function createCboStartDateReconstructSummaryReport() {
            cboStartDateReconstructSummaryReport.dispose();
            cboStartDateReconstructSummaryReport = new wijmo.input.InputDate('#cboStartDateReconstructSummaryReport', {
                format: 'MM-dd-yyyy',
                value: new Date(),
                mask: '99-99-9999',
                onValueChanged: function () {
                    if (cboStartDateReconstructSummaryReportIsClicked) {
                        NProgress.start();
                        refreshReconstructSummaryReportFlexGrid();
                    } else {
                        cboStartDateReconstructSummaryReportIsClicked = true;
                    }
                }
            });
        }

        var cboEndDateReconstructSummaryReportIsClicked = false;
        function createCboEndDateReconstructSummaryReport() {
            cboEndDateReconstructSummaryReport.dispose();
            cboEndDateReconstructSummaryReport = new wijmo.input.InputDate('#cboEndDateReconstructSummaryReport', {
                format: 'MM-dd-yyyy',
                value: new Date(),
                mask: '99-99-9999',
                onValueChanged: function () {
                    if (cboEndDateReconstructSummaryReportIsClicked) {
                        NProgress.start();
                        refreshReconstructSummaryReportFlexGrid();
                    } else {
                        cboEndDateReconstructSummaryReportIsClicked = true;
                    }
                }
            });
        }

        function getLoanRenewReconstructSummaryReport(loanType, areaId) {
            var startDate = [cboStartDateLoanSummaryReport.value.getMonth() + 1, cboStartDateLoanSummaryReport.value.getDate(), cboStartDateLoanSummaryReport.value.getFullYear()].join('-');
            var endDate = [cboEndDateLoanSummaryReport.value.getMonth() + 1, cboEndDateLoanSummaryReport.value.getDate(), cboEndDateLoanSummaryReport.value.getFullYear()].join('-');

            if (loanType == "loan") {
                startDate = [cboStartDateLoanSummaryReport.value.getMonth() + 1, cboStartDateLoanSummaryReport.value.getDate(), cboStartDateLoanSummaryReport.value.getFullYear()].join('-');
                endDate = [cboEndDateLoanSummaryReport.value.getMonth() + 1, cboEndDateLoanSummaryReport.value.getDate(), cboEndDateLoanSummaryReport.value.getFullYear()].join('-');
            } else {
                if (loanType == "renew") {
                    startDate = [cboStartDateRenewSummaryReport.value.getMonth() + 1, cboStartDateRenewSummaryReport.value.getDate(), cboStartDateRenewSummaryReport.value.getFullYear()].join('-');
                    endDate = [cboEndDateRenewSummaryReport.value.getMonth() + 1, cboEndDateRenewSummaryReport.value.getDate(), cboEndDateRenewSummaryReport.value.getFullYear()].join('-');
                } else {
                    if (loanType == "reconstruct") {
                        startDate = [cboStartDateReconstructSummaryReport.value.getMonth() + 1, cboStartDateReconstructSummaryReport.value.getDate(), cboStartDateReconstructSummaryReport.value.getFullYear()].join('-');
                        endDate = [cboEndDateReconstructSummaryReport.value.getMonth() + 1, cboEndDateReconstructSummaryReport.value.getDate(), cboEndDateReconstructSummaryReport.value.getFullYear()].join('-');
                    }
                }
            }

            var loanApplicationListArray = new wijmo.collections.ObservableArray;
            $.ajax({
                url: '/api/loan/renew/reconstruct/summary/report/' + loanType + '/' + areaId + '/' + startDate + '/' + endDate,
                cache: false,
                type: 'GET',
                contentType: 'application/json; charset=utf-8',
                success: function (loanApplicationListResult) {
                    if (loanApplicationListResult.length > 0) {
                        for (i = 0; i < loanApplicationListResult.length; i++) {

                            var newDate = new Date(loanApplicationListResult[i]["LoanDate"]);
                            var loanDateValue = ('0' + (newDate.getMonth() + 1)).slice(-2) + '-' + ('0' + newDate.getDate()).slice(-2) + '-' + newDate.getFullYear();

                            var loanStatus = "Active";
                            var docPrefix = "LN-";
                            if (loanApplicationListResult[i]["IsLoanReconstruct"]) {
                                loanStatus = "Overdue (Active)";
                                docPrefix = "RC-"
                                if (loanApplicationListResult[i]["IsReconstruct"]) {
                                    loanStatus = "Overdue (Reconstructed)";
                                } else {
                                    if (loanApplicationListResult[i]["IsRenew"]) {
                                        loanStatus = "Overdue (Renewed)";
                                    }
                                }
                            } else {
                                if (loanApplicationListResult[i]["IsLoanRenew"]) {
                                    docPrefix = "RN-"
                                }

                                if (loanApplicationListResult[i]["IsReconstruct"]) {
                                    loanStatus = "Reconstructed";
                                } else {
                                    if (loanApplicationListResult[i]["IsRenew"]) {
                                        loanStatus = "Renewed";
                                    }
                                }
                            }

                            var transactionType = "btnSummaryReportDetailLoan()";
                            if (loanApplicationListResult[i]["IsLoanRenew"]) {
                                transactionType = "btnSummaryReportDetailRenew()";
                            }

                            loanApplicationListArray.push({
                                DetailButton: "<button class='btn btn-primary btn-xs btn-block'  onclick='" + transactionType + "'><i class='fa fa-edit fa-fw'></i> Detail</button>",
                                Id: loanApplicationListResult[i]["Id"],
                                LoanNumber: docPrefix + loanApplicationListResult[i]["LoanNumber"],
                                LoanDate: loanDateValue,
                                Applicant: loanApplicationListResult[i]["Applicant"],
                                Area: loanApplicationListResult[i]["Area"],
                                Particulars: loanApplicationListResult[i]["Particulars"],
                                PrincipalAmount: loanApplicationListResult[i]["PrincipalAmount"],
                                InterestAmount: loanApplicationListResult[i]["InterestAmount"],
                                DeductionAmount: loanApplicationListResult[i]["DeductionAmount"],
                                NetAmount: loanApplicationListResult[i]["NetAmount"],
                                NetCollectionAmount: loanApplicationListResult[i]["NetCollectionAmount"],
                                TotalPaidAmount: loanApplicationListResult[i]["TotalPaidAmount"],
                                TotalPenaltyAmount: loanApplicationListResult[i]["TotalPenaltyAmount"],
                                TotalBalanceAmount: loanApplicationListResult[i]["TotalBalanceAmount"],
                                LoanStatus: loanStatus,
                                IsLocked: loanApplicationListResult[i]["IsLocked"],
                                CreatedByUserId: loanApplicationListResult[i]["CreatedByUserId"],
                                CreatedByUser: loanApplicationListResult[i]["CreatedByUser"],
                                CreatedDateTime: loanApplicationListResult[i]["CreatedDateTime"],
                                UpdatedByUserId: loanApplicationListResult[i]["UpdatedByUserId"],
                                UpdatedByUser: loanApplicationListResult[i]["UpdatedByUser"],
                                UpdatedDateTime: loanApplicationListResult[i]["UpdatedDateTime"],
                                RenewedDocNumber: loanApplicationListResult[i]["RenewedDocNumber"],
                                ReconstructedDocNumber: loanApplicationListResult[i]["ReconstructedDocNumber"],
                            });
                        }
                    }

                    NProgress.done();
                }
            });
            return loanApplicationListArray;
        }

        function btnSummaryReportDetailLoan() {

        }

        function btnSummaryReportDetailRenew() {

        }

        function refreshLoanSummaryReportFlexGrid() {
            loanRenewReconstructSummaryReportCollectionView = new wijmo.collections.CollectionView(getLoanRenewReconstructSummaryReport("loan", cboLoanSummaryReportArea.selectedItem["Id"]));
            loanRenewReconstructSummaryReportCollectionView.canFilter = true;
            loanRenewReconstructSummaryReportCollectionView.pageSize = 15;

            var filterText = '';
            $('#loanSummaryReportSearchInput').keyup(function () {
                filterText = this.value.toLowerCase();
                loanRenewReconstructSummaryReportCollectionView.refresh();
            });

            loanRenewReconstructSummaryReportCollectionView.filter = function (item) {
                return !filterText || (item.LoanNumber.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Applicant.toLowerCase().indexOf(filterText) > -1)
                                   || (item.LoanStatus.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Particulars.toLowerCase().indexOf(filterText) > -1);
            }

            loanRenewReconstructSummaryReportCollectionView.collectionChanged.addHandler(function (sender, args) {
                updateNavigateButtonsLoanSummary();
            });

            // Flex Grid
            loanSummaryReportFlexGrid.itemsSource = loanRenewReconstructSummaryReportCollectionView;
            loanSummaryReportFlexGrid.trackChanges = true;
        }

        function updateNavigateButtonsLoanSummary() {
            if (loanRenewReconstructSummaryReportCollectionView.pageSize <= 0) {
                document.getElementById('naviagtionPageGridLoanSummary').style.display = 'none';
                return;
            }
            document.getElementById('naviagtionPageGridLoanSummary').style.display = 'block';
            btnCurrentPageGridLoanSummary.innerHTML = (loanRenewReconstructSummaryReportCollectionView.pageIndex + 1) + ' / ' + loanRenewReconstructSummaryReportCollectionView.pageCount;
        }

        function createLoanSummaryReportFlexGrid() {
            loanRenewReconstructSummaryReportCollectionView = new wijmo.collections.CollectionView(getLoanRenewReconstructSummaryReport("loan", cboLoanSummaryReportArea.selectedItem["Id"]));
            loanRenewReconstructSummaryReportCollectionView.canFilter = true;
            loanRenewReconstructSummaryReportCollectionView.pageSize = 15;

            var filterText = '';
            $('#loanSummaryReportSearchInput').keyup(function () {
                filterText = this.value.toLowerCase();
                loanRenewReconstructSummaryReportCollectionView.refresh();
            });

            loanRenewReconstructSummaryReportCollectionView.filter = function (item) {
                return !filterText || (item.LoanNumber.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Applicant.toLowerCase().indexOf(filterText) > -1)
                                   || (item.LoanStatus.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Particulars.toLowerCase().indexOf(filterText) > -1);
            }

            loanRenewReconstructSummaryReportCollectionView.collectionChanged.addHandler(function (sender, args) {
                updateNavigateButtonsLoanSummary();
            });

            // Flex Grid
            loanSummaryReportFlexGrid = new wijmo.grid.FlexGrid('#loanSummaryReportFlexGrid');
            loanSummaryReportFlexGrid.initialize({
                columns: [
                            {
                                "header": "Detail",
                                "binding": "DetailButton",
                                "width": 100,
                                "align": "center",
                                "allowResizing": false,
                                "isContentHtml": true
                            },
                            {
                                "header": "Date",
                                "binding": "LoanDate",
                                "allowSorting": true,
                                "width": 100,
                            },
                            {
                                "header": "Loan No.",
                                "binding": "LoanNumber",
                                "allowSorting": true,
                                "width": 150,
                            },
                            {
                                "header": "Applicant",
                                "binding": "Applicant",
                                "allowSorting": true,
                                "width": 220,
                            },
                            {
                                "header": "Status",
                                "binding": "LoanStatus",
                                "allowSorting": true,
                                "width": 170,
                            },
                            {
                                "header": "Particulars",
                                "binding": "Particulars",
                                "allowSorting": true,
                                "width": 300,
                            },
                            {
                                "header": "Principal",
                                "binding": "PrincipalAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Net",
                                "binding": "NetAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Net Collection",
                                "binding": "NetCollectionAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Total Paid",
                                "binding": "TotalPaidAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Total Penalty",
                                "binding": "TotalPenaltyAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Total Balance",
                                "binding": "TotalBalanceAmount",
                                "allowSorting": true,
                                "width": 160,
                            }
                ],
                autoGenerateColumns: false,
                itemsSource: loanRenewReconstructSummaryReportCollectionView,
                isReadOnly: true,
                autoSizeMode: wijmo.grid.AutoSizeMode.Both,
                allowDragging: wijmo.grid.AllowDragging.None,
                selectionMode: wijmo.grid.SelectionMode.Row
            });

            loanSummaryReportFlexGrid.trackChanges = true;

            //Navigation button
            btnFirstPageGridLoanSummary = document.getElementById('btnMoveToFirstPageGridLoanSummary');
            btnPreviousPageGridLoanSummary = document.getElementById('btnMoveToPreviousPageGridLoanSummary');
            btnNextPageGridLoanSummary = document.getElementById('btnMoveToNextPageGridLoanSummary');
            btnLastPageGridLoanSummary = document.getElementById('btnMoveToLastPageGridLoanSummary');
            btnCurrentPageGridLoanSummary = document.getElementById('btnCurrentPageGridLoanSummary');

            updateNavigateButtonsLoanSummary();

            btnFirstPageGridLoanSummary.addEventListener('click', function () {
                loanRenewReconstructSummaryReportCollectionView.moveToFirstPage();
                updateNavigateButtonsLoanSummary();
            });
            btnPreviousPageGridLoanSummary.addEventListener('click', function () {
                loanRenewReconstructSummaryReportCollectionView.moveToPreviousPage();
                updateNavigateButtonsLoanSummary();
            });
            btnNextPageGridLoanSummary.addEventListener('click', function () {
                loanRenewReconstructSummaryReportCollectionView.moveToNextPage();
                updateNavigateButtonsLoanSummary();
            });
            btnLastPageGridLoanSummary.addEventListener('click', function () {
                loanRenewReconstructSummaryReportCollectionView.moveToLastPage();
                updateNavigateButtonsLoanSummary();
            });
        }

        function updateNavigateButtonsRenewSummary() {
            if (loanRenewReconstructSummaryReportCollectionView.pageSize <= 0) {
                document.getElementById('naviagtionPageGridRenewSummary').style.display = 'none';
                return;
            }
            document.getElementById('naviagtionPageGridRenewSummary').style.display = 'block';
            btnCurrentPageGridRenewSummary.innerHTML = (loanRenewReconstructSummaryReportCollectionView.pageIndex + 1) + ' / ' + loanRenewReconstructSummaryReportCollectionView.pageCount;
        }

        function refreshRenewSummaryReportFlexGrid() {
            loanRenewReconstructSummaryReportCollectionView = new wijmo.collections.CollectionView(getLoanRenewReconstructSummaryReport("renew", cboRenewSummaryReportArea.selectedItem["Id"]));
            loanRenewReconstructSummaryReportCollectionView.canFilter = true;
            loanRenewReconstructSummaryReportCollectionView.pageSize = 15;

            var filterText = '';
            $('#renewSummaryReportSearchInput').keyup(function () {
                filterText = this.value.toLowerCase();
                loanRenewReconstructSummaryReportCollectionView.refresh();
            });

            loanRenewReconstructSummaryReportCollectionView.filter = function (item) {
                return !filterText || (item.LoanNumber.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Applicant.toLowerCase().indexOf(filterText) > -1)
                                   || (item.LoanStatus.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Particulars.toLowerCase().indexOf(filterText) > -1)
                                   || (item.RenewedDocNumber.toLowerCase().indexOf(filterText) > -1);
            }

            loanRenewReconstructSummaryReportCollectionView.collectionChanged.addHandler(function (sender, args) {
                updateNavigateButtonsRenewSummary();
            });

            // Flex Grid
            renewSummaryReportFlexGrid.itemsSource = loanRenewReconstructSummaryReportCollectionView;
            renewSummaryReportFlexGrid.trackChanges = true;
        }

        function createRenewSummaryReportFlexGrid() {
            loanRenewReconstructSummaryReportCollectionView = new wijmo.collections.CollectionView(getLoanRenewReconstructSummaryReport("renew", cboRenewSummaryReportArea.selectedItem["Id"]));
            loanRenewReconstructSummaryReportCollectionView.canFilter = true;
            loanRenewReconstructSummaryReportCollectionView.pageSize = 15;

            var filterText = '';
            $('#renewSummaryReportSearchInput').keyup(function () {
                filterText = this.value.toLowerCase();
                loanRenewReconstructSummaryReportCollectionView.refresh();
            });

            loanRenewReconstructSummaryReportCollectionView.filter = function (item) {
                return !filterText || (item.LoanNumber.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Applicant.toLowerCase().indexOf(filterText) > -1)
                                   || (item.LoanStatus.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Particulars.toLowerCase().indexOf(filterText) > -1)
                                   || (item.RenewedDocNumber.toLowerCase().indexOf(filterText) > -1);
            }

            loanRenewReconstructSummaryReportCollectionView.collectionChanged.addHandler(function (sender, args) {
                updateNavigateButtonsRenewSummary();
            });

            // Flex Grid
            renewSummaryReportFlexGrid = new wijmo.grid.FlexGrid('#renewSummaryReportFlexGrid');
            renewSummaryReportFlexGrid.initialize({
                columns: [
                            {
                                "header": "Detail",
                                "binding": "DetailButton",
                                "width": 100,
                                "align": "center",
                                "allowResizing": false,
                                "isContentHtml": true
                            },
                            {
                                "header": "Date",
                                "binding": "LoanDate",
                                "allowSorting": true,
                                "width": 100,
                            },
                            {
                                "header": "Renew No.",
                                "binding": "LoanNumber",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Applicant",
                                "binding": "Applicant",
                                "allowSorting": true,
                                "width": 220,
                            },
                            {
                                "header": "Status",
                                "binding": "LoanStatus",
                                "allowSorting": true,
                                "width": 170,
                            },
                            {
                                "header": "Particulars",
                                "binding": "Particulars",
                                "allowSorting": true,
                                "width": 300,
                            },
                            {
                                "header": "Renewed Loan",
                                "binding": "RenewedDocNumber",
                                "allowSorting": true,
                                "width": 230,
                            },
                            {
                                "header": "Renew Amount",
                                "binding": "PrincipalAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Net",
                                "binding": "NetAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Net Collection",
                                "binding": "NetCollectionAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Total Paid",
                                "binding": "TotalPaidAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Total Penalty",
                                "binding": "TotalPenaltyAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Total Balance",
                                "binding": "TotalBalanceAmount",
                                "allowSorting": true,
                                "width": 160,
                            }
                ],
                autoGenerateColumns: false,
                itemsSource: loanRenewReconstructSummaryReportCollectionView,
                isReadOnly: true,
                autoSizeMode: wijmo.grid.AutoSizeMode.Both,
                allowDragging: wijmo.grid.AllowDragging.None,
                selectionMode: wijmo.grid.SelectionMode.Row
            });

            renewSummaryReportFlexGrid.trackChanges = true;

            //Navigation button
            btnFirstPageGridRenewSummary = document.getElementById('btnMoveToFirstPageGridRenewSummary');
            btnPreviousPageGridRenewSummary = document.getElementById('btnMoveToPreviousPageGridRenewSummary');
            btnNextPageGridRenewSummary = document.getElementById('btnMoveToNextPageGridRenewSummary');
            btnLastPageGridRenewSummary = document.getElementById('btnMoveToLastPageGridRenewSummary');
            btnCurrentPageGridRenewSummary = document.getElementById('btnCurrentPageGridRenewSummary');

            updateNavigateButtonsRenewSummary();

            btnFirstPageGridRenewSummary.addEventListener('click', function () {
                loanRenewReconstructSummaryReportCollectionView.moveToFirstPage();
                updateNavigateButtonsRenewSummary();
            });
            btnPreviousPageGridRenewSummary.addEventListener('click', function () {
                loanRenewReconstructSummaryReportCollectionView.moveToPreviousPage();
                updateNavigateButtonsRenewSummary();
            });
            btnNextPageGridRenewSummary.addEventListener('click', function () {
                loanRenewReconstructSummaryReportCollectionView.moveToNextPage();
                updateNavigateButtonsRenewSummary();
            });
            btnLastPageGridRenewSummary.addEventListener('click', function () {
                loanRenewReconstructSummaryReportCollectionView.moveToLastPage();
                updateNavigateButtonsRenewSummary();
            });
        }

        function refreshReconstructSummaryReportFlexGrid() {
            loanRenewReconstructSummaryReportCollectionView = new wijmo.collections.CollectionView(getLoanRenewReconstructSummaryReport("reconstruct", cboReconstructSummaryReportArea.selectedItem["Id"]));
            loanRenewReconstructSummaryReportCollectionView.canFilter = true;
            loanRenewReconstructSummaryReportCollectionView.pageSize = 15;

            var filterText = '';
            $('#reconstructSummaryReportSearchInput').keyup(function () {
                filterText = this.value.toLowerCase();
                loanRenewReconstructSummaryReportCollectionView.refresh();
            });

            loanRenewReconstructSummaryReportCollectionView.filter = function (item) {
                return !filterText || (item.LoanNumber.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Applicant.toLowerCase().indexOf(filterText) > -1)
                                   || (item.LoanStatus.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Particulars.toLowerCase().indexOf(filterText) > -1)
                                   || (item.ReconstructedDocNumber.toLowerCase().indexOf(filterText) > -1);
            }

            loanRenewReconstructSummaryReportCollectionView.collectionChanged.addHandler(function (sender, args) {
                updateNavigateButtonsRenewSummary();
            });

            // Flex Grid
            reconstructSummaryReportFlexGrid.itemsSource = loanRenewReconstructSummaryReportCollectionView;
            reconstructSummaryReportFlexGrid.trackChanges = true;
        }

        function updateNavigateButtonsReconstructSummary() {
            if (loanReconstructReconstructSummaryReportCollectionView.pageSize <= 0) {
                document.getElementById('naviagtionPageGridReconstructSummary').style.display = 'none';
                return;
            }
            document.getElementById('naviagtionPageGridReconstructSummary').style.display = 'block';
            btnCurrentPageGridReconstructSummary.innerHTML = (loanReconstructReconstructSummaryReportCollectionView.pageIndex + 1) + ' / ' + loanRenewReconstructSummaryReportCollectionView.pageCount;
        }

        function createReconstructSummaryReportFlexGrid() {
            loanReconstructReconstructSummaryReportCollectionView = new wijmo.collections.CollectionView(getLoanRenewReconstructSummaryReport("reconstruct", cboReconstructSummaryReportArea.selectedItem["Id"]));
            loanReconstructReconstructSummaryReportCollectionView.canFilter = true;
            loanReconstructReconstructSummaryReportCollectionView.pageSize = 15;

            var filterText = '';
            $('#reconstructSummaryReportSearchInput').keyup(function () {
                filterText = this.value.toLowerCase();
                loanReconstructReconstructSummaryReportCollectionView.refresh();
            });

            loanReconstructReconstructSummaryReportCollectionView.filter = function (item) {
                return !filterText || (item.LoanNumber.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Applicant.toLowerCase().indexOf(filterText) > -1)
                                   || (item.LoanStatus.toLowerCase().indexOf(filterText) > -1)
                                   || (item.Particulars.toLowerCase().indexOf(filterText) > -1)
                                   || (item.ReconstructedDocNumber.toLowerCase().indexOf(filterText) > -1);
            }

            loanReconstructReconstructSummaryReportCollectionView.collectionChanged.addHandler(function (sender, args) {
                updateNavigateButtonsReconstructSummary();
            });

            // Flex Grid
            reconstructSummaryReportFlexGrid = new wijmo.grid.FlexGrid('#reconstructSummaryReportFlexGrid');
            reconstructSummaryReportFlexGrid.initialize({
                columns: [
                            {
                                "header": "Detail",
                                "binding": "DetailButton",
                                "width": 100,
                                "align": "center",
                                "allowResizing": false,
                                "isContentHtml": true
                            },
                            {
                                "header": "Date",
                                "binding": "LoanDate",
                                "allowSorting": true,
                                "width": 100,
                            },
                            {
                                "header": "Recon. No.",
                                "binding": "LoanNumber",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Applicant",
                                "binding": "Applicant",
                                "allowSorting": true,
                                "width": 220,
                            },
                            {
                                "header": "Status",
                                "binding": "LoanStatus",
                                "allowSorting": true,
                                "width": 170,
                            },
                            {
                                "header": "Particulars",
                                "binding": "Particulars",
                                "allowSorting": true,
                                "width": 300,
                            },
                            {
                                "header": "Reconstructed Loan",
                                "binding": "ReconstructedDocNumber",
                                "allowSorting": true,
                                "width": 230,
                            },
                            {
                                "header": "Recon. Amount",
                                "binding": "PrincipalAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Net Collection",
                                "binding": "NetCollectionAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Total Paid",
                                "binding": "TotalPaidAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Total Penalty",
                                "binding": "TotalPenaltyAmount",
                                "allowSorting": true,
                                "width": 160,
                            },
                            {
                                "header": "Total Balance",
                                "binding": "TotalBalanceAmount",
                                "allowSorting": true,
                                "width": 160,
                            }
                ],
                autoGenerateColumns: false,
                itemsSource: loanRenewReconstructSummaryReportCollectionView,
                isReadOnly: true,
                autoSizeMode: wijmo.grid.AutoSizeMode.Both,
                allowDragging: wijmo.grid.AllowDragging.None,
                selectionMode: wijmo.grid.SelectionMode.Row
            });

            reconstructSummaryReportFlexGrid.trackChanges = true;

            //Navigation button
            btnFirstPageGridReconstructSummary = document.getElementById('btnMoveToFirstPageGridReconstructSummary');
            btnPreviousPageGridReconstructSummary = document.getElementById('btnMoveToPreviousPageGridReconstructSummary');
            btnNextPageGridReconstructSummary = document.getElementById('btnMoveToNextPageGridReconstructSummary');
            btnLastPageGridReconstructSummary = document.getElementById('btnMoveToLastPageGridReconstructSummary');
            btnCurrentPageGridReconstructSummary = document.getElementById('btnCurrentPageGridReconstructSummary');

            updateNavigateButtonsReconstructSummary();

            btnFirstPageGridReconstructSummary.addEventListener('click', function () {
                loanReconstructReconstructSummaryReportCollectionView.moveToFirstPage();
                updateNavigateButtonsReconstructSummary();
            });
            btnPreviousPageGridReconstructSummary.addEventListener('click', function () {
                loanReconstructReconstructSummaryReportCollectionView.moveToPreviousPage();
                updateNavigateButtonsReconstructSummary();
            });
            btnNextPageGridReconstructSummary.addEventListener('click', function () {
                loanReconstructReconstructSummaryReportCollectionView.moveToNextPage();
                updateNavigateButtonsReconstructSummary();
            });
            btnLastPageGridReconstructSummary.addEventListener('click', function () {
                loanReconstructReconstructSummaryReportCollectionView.moveToLastPage();
                updateNavigateButtonsReconstructSummary();
            });
        }

        window.onload = function () {
            cboDailyReleaseMonitoringArea = new wijmo.input.ComboBox('#cboDailyReleaseMonitoringArea');
            cboLoanSummaryReportArea = new wijmo.input.ComboBox('#cboLoanSummaryReportArea');
            cboRenewSummaryReportArea = new wijmo.input.ComboBox('#cboRenewSummaryReportArea');
            cboReconstructSummaryReportArea = new wijmo.input.ComboBox('#cboReconstructSummaryReportArea');
            createCboArea();
            cboStartDateLoanSummaryReport = new wijmo.input.InputDate('#cboStartDateLoanSummaryReport');
            createCboStartDateLoanSummaryReport();
            cboEndDateLoanSummaryReport = new wijmo.input.InputDate('#cboEndDateLoanSummaryReport');
            createCboEndDateLoanSummaryReport();
            cboStartDateRenewSummaryReport = new wijmo.input.InputDate('#cboStartDateRenewSummaryReport');
            createCboStartDateRenewSummaryReport();
            cboEndDateRenewSummaryReport = new wijmo.input.InputDate('#cboEndDateRenewSummaryReport');
            createCboEndDateRenewSummaryReport();
            cboStartDateReconstructSummaryReport = new wijmo.input.InputDate('#cboStartDateReconstructSummaryReport');
            createCboStartDateReconstructSummaryReport();
            cboEndDateReconstructSummaryReport = new wijmo.input.InputDate('#cboEndDateReconstructSummaryReport');
            createCboEndDateReconstructSummaryReport();
        }
    </script>
</body>
</html>